<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>JorgenSkagg</title>

    <style>
        main {
            margin-top: 6vh;
            display: flex;
            align-items: center;
            flex-direction: column;
        }

        p {
            font-size: 3vh
        }
    </style>
</head>
<body>

    <main id="main">
        <p>Mästeren av allt från Objective Pascal till .NET!<p>

            <div id="img-container"></div>

            <div>
                <p id="hometown"></p>
                <p id="temp"></p>
                <p id="pressure"></p>
                <p id="humidity"></p>
                <p id="speed"></p>
            </div>
    </main>

    <script>
        // New elements
        const pingTag = document.createElement("p");
        const img = document.createElement("img");

        // Get elements
        const imageContainer = document.getElementById("img-container");
        const mainConainer = document.getElementById("main");

        const temp = document.getElementById("temp");
        const pressure = document.getElementById("pressure");
        const humidity = document.getElementById("humidity");
        const speed = document.getElementById("speed");
        const hometowm = document.getElementById("hometown");

        // Set attributes
        img.setAttribute("src", "https://jorgen-67273.azurewebsites.net/Jorgen");
        img.setAttribute("height", "250");
        img.setAttribute("width", "250");
        img.setAttribute("alt", "jorgen_img");
        imageContainer.appendChild(img);

        try {
            fetch("https://jorgen-67273.azurewebsites.net/Jorgen/getweather", {
                headers: {
                    method: 'GET',
                    "Content-Type": "text/plain"
                }
            }).then(response => {
                if (!response.ok) {
                    throw new Error("HTTP error", + response.status);
                }

                return response.json();
            }).then(json => {
                hometowm.innerHTML = "Jörgens stad Veberöd";
                temp.innerHTML = "Temperature: " + json.temp + " °C";
                pressure.innerHTML = "Pressure: " + json.pressure + " hPa";
                humidity.innerHTML = "Humidity: " + json.humidity + " %";
                speed.innerHTML = "Speed: " + json.speed + " m/s";

            }).catch(error => {
                pingTag.innerHTML = `Could not get weather data inside try: ${error.message}`;
                mainConainer.appendChild(pingTag)
            })
        } catch (error) {
            pingTag.innerHTML = `Could not get weather dataoutside try: ${error.message}`;
        }



        // Ping holder
        //pingTag.innerHTML = "Listening...";
        //mainConainer.appendChild(pingTag);
        //pingTag.id = "ping-tag"

        //let randomNumber =  Math.floor(Math.random() * (5000 - 2000 + 1))

        //// Listen for ping
        //try {
        //    fetch("https://localhost:7071/Jorgen/getweather" {
        //        headers: {
        //            method: 'GET',
        //            "Content-Type": "text/plain"
        //        }
        //    }).then(response => {
        //        pingTag.innerHTML = response.status == 200 ? "Ping" : "Something went wrong"
        //        mainConainer.appendChild(pingTag)
        //        pingTag.style.animation = "none"
        //    }).catch(error => {
        //        pingTag.innerHTML = `Ping not responing inside try: ${error.message}`;
        //        mainConainer.appendChild(pingTag)
        //        pingTag.style.animation = "none"
        //    })
        //} catch (error) {
        //    pingTag.innerHTML = `Ping not responding outside try: ${error.message}`;
        //    pingTag.style.animation = "none"
        //}

    </script>

</body>
</html>